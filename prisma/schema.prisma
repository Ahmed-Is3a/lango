generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

enum StoryLevel {
  A1
  A2
  B1
  B2
  C1
  C2
}

model User {
  id    Int     @id @default(autoincrement())
  email String  @unique
  name  String?
}

model Vocabulary {
  id          Int      @id @default(autoincrement())
  term        String
  definition  String
  language    String
  createdAt   DateTime @default(now())
  exampleGerman  String?
  exampleEnglish String?
  imageUrl    String?
  lessons     Lesson[]
}

enum QuizLevel {
  A1
  A2
  B1
  B2
  C1
  C2
}

enum QuizQuestionType {
  MCQ
  TRUE_FALSE
  FILL_IN_THE_BLANK
  MATCHING
}

model QuizQuestion {
  id        Int              @id @default(autoincrement())
  type      QuizQuestionType @default(MCQ)
  data      Json             @default("{}")
  level     QuizLevel        @default(A1)
  tags      String[]         @default([])
  createdAt DateTime         @default(now())
}

model Story {
  id           Int         @id @default(autoincrement())
  title        String
  slug         String      @unique
  content      String
  translation  String
  coverImage   String?
  audioUrl     String?
  level        StoryLevel  @default(A1)
  language     String      @default("en")
  createdAt    DateTime    @default(now())
  updatedAt    DateTime    @updatedAt
}

enum LessonLevel {
  A1
  A2
  B1
  B2
  C1
  C2
}

model Level {
  id         Int       @id @default(autoincrement())
  slug       String    @unique
  title      String
  description String?
  order      Int       @default(0)
  createdAt  DateTime  @default(now())
  updatedAt  DateTime  @updatedAt
  lessons    Lesson[]
}

enum LessonStatus {
  draft
  published
}

model Lesson {
  id            Int          @id @default(autoincrement())
  slug          String       @unique
  title         String
  levelId       Int
  level         Level        @relation(fields: [levelId], references: [id], onDelete: Cascade)
  language      String       @default("en")
  levelTag      LessonLevel  @default(A1)
  status        LessonStatus @default(draft)
  order         Int          @default(0)
  blocks        Json
  vocabularies  Vocabulary[]
  createdAt     DateTime     @default(now())
  updatedAt     DateTime     @updatedAt

  @@index([levelId, order])
}
